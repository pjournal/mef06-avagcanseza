students <- reshape2::melt(students, id = c("university", "university_type", "country", "nationality"), variable.name = "sex", value.name="count")
students$count <- as.numeric(students$count)
df1 <- students %>%
group_by(sex) %>%
summarise(count = sum(count)) %>%
mutate(count_perc = scales::percent(round(count / sum(count), 2)))
df1 %>%
ggplot(aes(x = "", y = count_perc, fill= sex)) +
geom_bar(stat="identity", width=1) +
geom_text(aes(label = count_perc),
position = position_stack(vjust = 0.5)) +
coord_polar("y", start=0) +
labs(title = "Sex Distribution") +
xlab("") +
ylab("")
df2 <- students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
mutate(perc = count / sum(count))
df2 %>% ggplot(aes(x = reorder(country, -perc), y = perc, fill = sex)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Sex Distribution by Country") +
xlab("Country") +
ylab("Percentage")
students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female)))
students
df1 <- students %>%
group_by(sex) %>%
summarise(count = sum(count)) %>%
mutate(count_perc = scales::percent(round(count / sum(count), 2)))
df1
df1 %>%
ggplot(aes(x = "", y = count_perc, fill= sex)) +
geom_bar(stat="identity", width=1) +
geom_text(aes(label = count_perc),
position = position_stack(vjust = 0.5)) +
coord_polar("y", start=0) +
labs(title = "Sex Distribution") +
xlab("") +
ylab("")
library(dplyr)
library(readxl)
library(tidyr)
library(ggplot2)
library(reshape)
library(tidyverse)
library(scales)
options(dplyr.summarise.inform = FALSE)
df1 %>%
ggplot(aes(x = "", y = count_perc, fill= sex)) +
geom_bar(stat="identity", width=1) +
geom_text(aes(label = count_perc),
position = position_stack(vjust = 0.5)) +
coord_polar("y", start=0) +
labs(title = "Sex Distribution") +
xlab("") +
ylab("")
students
students %>%
group_by(nationality, sex) %>%
summarise(count = sum(count))
df3 <- students %>%
group_by(nationality, sex) %>%
summarise(count = sum(count))
df3 <- filter(sex == "female")
df3 %>% filter(sex == "female")
df3 %>% filter(sex == "female") %>%
arrange(desc(count))
df3 %>% filter(sex == "female") %>%
arrange(desc(count)) %>%
top_n(10, count)
df3 %>% filter(sex == "female") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
female_tops <- df3 %>% filter(sex == "female") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
female_tops <- df3 %>% filter(sex == "female") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
male_tops <- df3 %>% filter(sex == "male") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
all_tops <- rbind(female_tops, male_tops)
all_tops
all_tops %>% ggplot(aes(x = nationality, y = count, fill = sex)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Sex Distribution by Nationality") +
xlab("Nationality") +
ylab("Percentage")
all_tops %>% ggplot(aes(x = nationality, y = count, fill = sex)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Sex Distribution by Nationality") +
xlab("Nationality") +
ylab("Percentage")
all_tops %>% ggplot(aes(x = reorder(nationality, -count), y = count, fill = sex)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Sex Distribution by Nationality") +
xlab("Nationality") +
ylab("Percentage")
all_tops %>% ggplot(aes(x = reorder(nationality, count), y = count, fill = sex)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Sex Distribution by Nationality") +
xlab("Nationality") +
ylab("Percentage")
all_tops %>% ggplot(aes(x = reorder(nationality, count), y = count, fill = sex)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Sex Distribution by Nationality") +
xlab("Nationality") +
ylab("Count")
female_tops <- df3 %>% filter(sex == "female") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
male_tops <- df3 %>% filter(sex == "male") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
all_tops <- rbind(female_tops, male_tops)
all_tops %>% ggplot(aes(x = reorder(nationality, count), y = count, fill = sex)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Sex Distribution by Nationality") +
xlab("Nationality") +
ylab("Count")
students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(names_to = sex, values_to = perc)
students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(!country, names_to = sex, values_to = perc)
students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(!country, names_to = "sex", values_to = "perc")
df4 <- students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(!country, names_to = "sex", values_to = "perc")
df4 %>% ggplot(aes(x = country, y = perc, color = sex)) + geom_line()
df4
df4 <- students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = male / sum(male), female = female / sum(female)) %>%
pivot_longer(!country, names_to = "sex", values_to = "perc")
df4 %>% ggplot(aes(x = country, y = perc, color = sex)) + geom_line()
df4 %>% ggplot(aes(x = country, y = perc, color = sex)) + geom_bar()
df4 %>% ggplot(aes(x = country, y = perc, fill = sex)) + geom_bar()
df4
df4 <- students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(!country, names_to = "sex", values_to = "perc")
df4
df4 %>% filter(sex == "female")
df4 %>%
filter(sex == "female") %>%
arrange(desc(perc))
df4 %>%
filter(sex == "female") %>%
arrange(desc(perc)) %>%
top_n(10, perc)
df4 %>%
filter(sex == "male") %>%
arrange(desc(perc)) %>%
top_n(10, perc)
df4 <- students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(!country, names_to = "sex", values_to = "perc") %>%
filter(sex == "male") %>%
arrange(desc(perc)) %>%
top_n(10, perc)
students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(!country, names_to = "sex", values_to = "perc") %>%
filter(sex == "male") %>%
arrange(desc(perc)) %>%
top_n(10, perc)
students %>%
group_by(country, sex) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = sex, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(!country, names_to = "sex", values_to = "perc") %>%
filter(sex == "female") %>%
arrange(desc(perc)) %>%
top_n(10, perc)
shiny::runApp('ForeignStudentAnalysis')
library(dplyr)
library(readxl)
library(tidyr)
library(ggplot2)
library(reshape)
library(tidyverse)
library(scales)
options(dplyr.summarise.inform = FALSE)
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
library(dplyr)
library(readxl)
library(tidyr)
library(ggplot2)
library(reshape)
library(tidyverse)
library(scales)
options(dplyr.summarise.inform = FALSE)
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
library(dplyr)
library(readxl)
library(tidyr)
library(ggplot2)
library(reshape)
library(tidyverse)
library(scales)
options(dplyr.summarise.inform = FALSE)
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
file.choose()
students<-read_excel("C:\\Users\\serda\\OneDrive\\Belgeler\\GitHub\\mef06-avagcanseza\\docs\\foreign_students_by_nationality_2021_2022.xlsx")
students %>% glimpse()
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students<-read_excel("C:\\Users\\serda\\OneDrive\\Belgeler\\GitHub\\mef06-avagcanseza\\docs\\foreign_students_by_nationality_2021_2022.xlsx")
library(dplyr)
library(readxl)
library(tidyr)
library(ggplot2)
library(reshape)
library(tidyverse)
library(scales)
options(dplyr.summarise.inform = FALSE)
library(dplyr)
library(readxl)
library(tidyr)
library(ggplot2)
library(reshape)
library(tidyverse)
library(scales)
options(dplyr.summarise.inform = FALSE)
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students<-read_excel("C:\\Users\\serda\\OneDrive\\Belgeler\\GitHub\\mef06-avagcanseza\\docs\\foreign_students_by_nationality_2021_2022.xlsx")
shiny::runApp('C:/Users/serda/OneDrive/Masaüstü/deleteme')
library(dplyr)
library(readxl)
library(tidyr)
library(ggplot2)
library(reshape)
library(tidyverse)
library(scales)
options(dplyr.summarise.inform = FALSE)
library(dplyr)
library(readxl)
library(tidyr)
library(ggplot2)
library(reshape)
library(tidyverse)
library(scales)
options(dplyr.summarise.inform = FALSE)
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students %>% glimpse()
new_cols <- c("university","university_type","country","nationality","male","female","total")
colnames(students) <- new_cols
students <- na.omit(students)
students <- students %>%
select('university':'female')
students <- reshape2::melt(students, id = c("university", "university_type", "country", "nationality"), variable.name = "sex", value.name="count")
students$count <- as.numeric(students$count)
students$count <- as.numeric(students$count)
df1 <- students %>%
group_by(sex) %>%
summarise(count = sum(count)) %>%
mutate(count_perc = scales::percent(round(count / sum(count), 2)))
students$count <- as.numeric(students$count)
saveRDS(data, file = "students.Rds")
saveRDS(data, file = "docs/students.Rds")
students <- reshape2::melt(students, id = c("university", "university_type", "country", "nationality"), variable.name = "gender", value.name="count")
new_cols <- c("university","university_type","country","nationality","male","female","total")
colnames(students) <- new_cols
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students %>% glimpse()
new_cols <- c("university","university_type","country","nationality","male","female","total")
colnames(students) <- new_cols
students <- na.omit(students)
students <- students %>%
select('university':'female')
students <- reshape2::melt(students, id = c("university", "university_type", "country", "nationality"), variable.name = "gender", value.name="count")
students$count <- as.numeric(students$count)
saveRDS(data, file = "docs/students.Rds")
df1 %>%
ggplot(aes(x = "", y = count_perc, fill= gender)) +
geom_bar(stat="identity", width=1) +
geom_text(aes(label = count_perc),
position = position_stack(vjust = 0.5)) +
coord_polar("y", start=0) +
labs(title = "Gender Distribution") +
xlab("") +
ylab("")
df1 <- students %>%
group_by(gender) %>%
summarise(count = sum(count)) %>%
mutate(count_perc = scales::percent(round(count / sum(count), 2)))
df1 %>%
ggplot(aes(x = "", y = count_perc, fill= gender)) +
geom_bar(stat="identity", width=1) +
geom_text(aes(label = count_perc),
position = position_stack(vjust = 0.5)) +
coord_polar("y", start=0) +
labs(title = "Gender Distribution") +
xlab("") +
ylab("")
df2 <- students %>%
group_by(country, gender) %>%
summarise(count = sum(count)) %>%
mutate(perc = count / sum(count))
df2 %>% ggplot(aes(x = reorder(country, -perc), y = perc, fill = gender)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Gender Distribution by Country") +
xlab("Country") +
ylab("Percentage")
students %>%
group_by(country, gender) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = gender, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(!country, names_to = "gender", values_to = "perc") %>%
filter(gender == "female") %>%
arrange(desc(perc)) %>%
top_n(10, perc)
df3 <- students %>%
group_by(nationality, gender) %>%
summarise(count = sum(count))
female_tops <- df3 %>% filter(gender == "female") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
male_tops <- df3 %>% filter(gender == "male") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
all_tops <- rbind(female_tops, male_tops)
female_tops <- df3 %>% filter(gender == "female") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
male_tops <- df3 %>% filter(gender == "male") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
all_tops <- rbind(female_tops, male_tops)
all_tops %>% ggplot(aes(x = reorder(nationality, count), y = count, fill = gender)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Gender Distribution by Nationality") +
xlab("Nationality") +
ylab("Count")
shiny::runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
saveRDS(data, file = "ForeignStudentAnalysis/students.Rds")
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
library(dplyr)
library(readxl)
library(tidyr)
library(ggplot2)
library(reshape)
library(tidyverse)
library(scales)
options(dplyr.summarise.inform = FALSE)
students<-read_excel("docs/foreign_students_by_nationality_2021_2022.xlsx")
students %>% glimpse()
new_cols <- c("university","university_type","country","nationality","male","female","total")
colnames(students) <- new_cols
students <- na.omit(students)
students <- students %>%
select('university':'female')
students <- reshape2::melt(students, id = c("university", "university_type", "country", "nationality"), variable.name = "gender", value.name="count")
students$count <- as.numeric(students$count)
saveRDS(data, file = "docs/students.Rds")
df1 <- students %>%
group_by(gender) %>%
summarise(count = sum(count)) %>%
mutate(count_perc = scales::percent(round(count / sum(count), 2)))
df1 %>%
ggplot(aes(x = "", y = count_perc, fill= gender)) +
geom_bar(stat="identity", width=1) +
geom_text(aes(label = count_perc),
position = position_stack(vjust = 0.5)) +
coord_polar("y", start=0) +
labs(title = "Gender Distribution") +
xlab("") +
ylab("")
df2 <- students %>%
group_by(country, gender) %>%
summarise(count = sum(count)) %>%
mutate(perc = count / sum(count))
df2 %>% ggplot(aes(x = reorder(country, -perc), y = perc, fill = gender)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Gender Distribution by Country") +
xlab("Country") +
ylab("Percentage")
students %>%
group_by(country, gender) %>%
summarise(count = sum(count)) %>%
pivot_wider(names_from = gender, values_from = count) %>%
ungroup() %>%
mutate(male = percent(male / sum(male)), female = percent(female / sum(female))) %>%
pivot_longer(!country, names_to = "gender", values_to = "perc") %>%
filter(gender == "female") %>%
arrange(desc(perc)) %>%
top_n(10, perc)
df3 <- students %>%
group_by(nationality, gender) %>%
summarise(count = sum(count))
female_tops <- df3 %>% filter(gender == "female") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
male_tops <- df3 %>% filter(gender == "male") %>%
arrange(desc(count)) %>%
ungroup() %>%
top_n(10, count)
all_tops <- rbind(female_tops, male_tops)
all_tops %>% ggplot(aes(x = reorder(nationality, count), y = count, fill = gender)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Gender Distribution by Nationality") +
xlab("Nationality") +
ylab("Count")
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
glimpse(students)
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
runApp('ForeignStudentAnalysis')
