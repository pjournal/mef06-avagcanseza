"0","df6 <- reasons_of_not_being_in_lab_for %>%"
"0","  group_by(gender, reason) %>%"
"0","  summarise(pop_not_in_lab_force = sum(pop_not_in_lab_force), .groups = ""drop"")"
"0",""
"0","df7 <- df6 %>% "
"0","  filter(reason == ""Total"") %>%"
"0","  select(gender, total_pop_not_in_lab_force = pop_not_in_lab_force)"
"0",""
"0","df8 <- df6 %>% "
"0","  filter(reason != ""Total"")"
"0",""
"0","df9 <- df7 %>%"
"0","  inner_join(df8, by = ""gender"") %>%"
"0","  mutate(pop_not_in_lab_force_rate = pop_not_in_lab_force / total_pop_not_in_lab_force) %>%"
"0","  select(gender, reason, pop_not_in_lab_force_rate)"
"0",""
"0","df9 %>%"
"0","  ggplot(aes(x = """", y = pop_not_in_lab_force_rate, fill = reason )) +"
"0","  geom_bar(width = 1, stat = ""identity"") +"
"0","  coord_polar(""y"", start=0) +"
"0","  geom_text(aes(label = scales::percent(round(pop_not_in_lab_force_rate,2))),"
"0","            position = position_stack(vjust = 0.5), size = 2, angle = -80) +"
"0","  facet_wrap( ~ gender) +"
"0","  xlab("""") +"
"0","  ylab("""") +"
"0","  theme_void() +"
"0","  theme(legend.text=element_text(size=4), legend.position = ""bottom"", legend.title=element_blank())"
